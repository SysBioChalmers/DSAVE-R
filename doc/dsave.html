<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Johan Gustafsson, Juan Inda" />

<meta name="date" content="2019-06-13" />

<title>DSAVE package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">DSAVE package</h1>
<h4 class="author">Johan Gustafsson, Juan Inda</h4>
<h4 class="date">2019-06-13</h4>



<div id="overview" class="section level2">
<h2>1 Overview</h2>
<p>DSAVE (Down-SAmpling based Variation Estimation) is a package that can be used for investigating the cell-to-cell variation in single-cell RNA-Seq data. DSAVE divides the variation into two components; sampling noise and BTM (Biological, Technical and Misclassification) variation. The sampling noise is a function of the number of reads per cell, while the BTM variation contains interesting information about technical artefacts, biological variation, and cell misclassifications. The sampling noise typically varies between datasets and is often the dominating variation factor, often obscuring the BTM variation if not separated with a method such as DSAVE.</p>
<p>BTM variation can be explained the following way: For each mapped read from a cell in a cell population, there is a certain chance that this will belong to a certain gene. This probability is based on the mean expression of that gene in the entire population. If no BTM variation exists, the reads will be sampled according to these gene probabilities the same way in all cells, and we will get only sampling noise. In this context, BTM variation is the variation between cells in the probabilities used when sampling reads.</p>
<p>The package works on cell populations containing similar cells. The cells are expected to be classified into cell types if the dataset has a mix of cell types, and the total cell population need to be divided into populations per cell type to give meaningful results. We have shown that if the BTM variation of a whole cell population is large compared to other datasets, the reason for this is most likely technical; biological variation is often smaller when compared over the whole gene range.</p>
<p>DSAVE supports 4 types of calculations:</p>
<ul>
<li><p>DSAVE Total Variation Estimation - This metric measures the total variation, including sampling noise, for the mean expression over a gene range for a pool of single-cells of a certain size. The metric is useful for determining the pool size needed to obtain the same variation as in for example typical bulk RNA-Seq data. The calculations include generation of sampling noise only (SNO) datasets, which are randomly generated by sampling from a multinomial distribution with probabilities calculated from the mean expression of the cell population.</p></li>
<li><p>DSAVE BTM Variation Score - gives an overall score of the variation. The function uses a template, which is used for making the metric comparable across cell populations and even datasets. The score from a dataset can be compared to that of other datasets to see that the technical variation is comparable to that of others.</p></li>
<li><p>DSAVE Gene-Wise Variation - This metric measures the BTM variation per gene, in similar ways as the BTM variation score. Due to sampling stochasticity, the variation of a gene may however vary just by chance. We therefore also produce p values describing the probability that the variation comes from sampling only (the null hypothesis). For the BTM score this is not a problem since the result is averaged over many genes, but for the gene-wise metric this needs to be taken into account. The gene-wise metric is not comparable across datasets.</p></li>
<li><p>DSAVE Cell-Wise Variation - This metric measures the log-likelihood for that a cell is sampled from the mean expression of the cell population. The lower (more negative) the log-likelihood is, the the cell diverges from the mean of the population. The metric is comparable between cells in a cell population, but not across cell populations or datasets. The metric can for example be useful for finding thresholds for known cell filtration metrics, such as UMI counts and MT gene content.</p></li>
</ul>
</div>
<div id="total-variation" class="section level2">
<h2>2 Total Variation</h2>
<ul>
<li>Load the package.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(DSAVE)
<span class="kw">library</span>(progress)
<span class="co">#&gt; Warning: package 'progress' was built under R version 3.5.3</span></code></pre></div>
<ul>
<li>Download the datasets to analyze.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bcells &lt;-<span class="st"> </span><span class="kw">loadOrDownloadB10k</span>()
tcells &lt;-<span class="st"> </span><span class="kw">loadOrDownloadT4k</span>()</code></pre></div>
<ul>
<li>Calculate the Total Variation for different pool sizes.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scTotalVariation_bcells &lt;-<span class="st"> </span><span class="kw">list</span>()
scTotalVariation_tcells &lt;-<span class="st"> </span><span class="kw">list</span>()
pools &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">750</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2000</span>, <span class="dv">3000</span>, <span class="dv">4000</span>, <span class="dv">5000</span>)
pools2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">750</span>, <span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">2250</span>)
pb &lt;-<span class="st"> </span>progress_bar<span class="op">$</span><span class="kw">new</span>(<span class="dt">format =</span> <span class="st">&quot;Calculating [:bar] :percent eta: :eta&quot;</span>,
                       <span class="dt">total =</span> <span class="kw">length</span>(pools) <span class="op">+</span><span class="st"> </span><span class="kw">length</span>(pools2), <span class="dt">clear =</span> <span class="ot">FALSE</span>)

<span class="cf">for</span>(poolSize <span class="cf">in</span> pools){
  scTotalVariation_bcells[[<span class="kw">as.character</span>(poolSize)]] &lt;-<span class="st"> </span><span class="kw">DSAVEGetTotalVariationPoolSize</span>(bcells,
        <span class="dt">poolSize =</span> poolSize, <span class="dt">upperBound =</span> <span class="fl">1e5</span>, <span class="dt">lowerBound =</span> <span class="fl">5e-1</span>)
  pb<span class="op">$</span><span class="kw">tick</span>();
}

<span class="cf">for</span>(poolSize <span class="cf">in</span> pools2){
  scTotalVariation_tcells[[<span class="kw">as.character</span>(poolSize)]] &lt;-<span class="st"> </span><span class="kw">DSAVEGetTotalVariationPoolSize</span>(tcells,
          <span class="dt">poolSize =</span> poolSize, <span class="dt">upperBound =</span> <span class="fl">1e5</span>, <span class="dt">lowerBound =</span> <span class="fl">5e-1</span>)
  pb<span class="op">$</span><span class="kw">tick</span>();
}

pb<span class="op">$</span><span class="kw">terminate</span>()</code></pre></div>
<ul>
<li>Plot the results</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bulkMean1Vs1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">mean</span>(bulkTotalVar1vs1[[<span class="dv">1</span>]][[<span class="dv">2</span>]]), <span class="dv">2</span>)
bulkMean4Vs4 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">mean</span>(bulkTotalVar4vs4[[<span class="dv">1</span>]][[<span class="dv">2</span>]]), <span class="dv">2</span>)
sc &lt;-<span class="st"> </span><span class="kw">rbind</span>(
  <span class="kw">cbind</span>(pools, <span class="kw">sapply</span>(scTotalVariation_bcells, 
                      <span class="cf">function</span>(v) <span class="kw">mean</span>(v)), <span class="st">&quot;B10k&quot;</span>, <span class="st">&quot;sc&quot;</span>), 
  <span class="kw">cbind</span>(pools2, <span class="kw">sapply</span>(scTotalVariation_tcells, 
                       <span class="cf">function</span>(v) <span class="kw">mean</span>(v)), <span class="st">&quot;T4k&quot;</span>, <span class="st">&quot;sc&quot;</span>), 
  <span class="kw">cbind</span>(<span class="kw">c</span>(pools[<span class="dv">1</span>],pools[<span class="kw">length</span>(pools)]), 
        bulkMean1Vs1, <span class="st">&quot;single bulk sample&quot;</span>, <span class="st">&quot;bulk&quot;</span>),
  <span class="kw">cbind</span>(<span class="kw">c</span>(pools[<span class="dv">1</span>],pools[<span class="kw">length</span>(pools)]), 
        bulkMean4Vs4, <span class="st">&quot;mean of 4 bulk samples&quot;</span>, <span class="st">&quot;bulk&quot;</span>))

sc &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(sc)
<span class="kw">colnames</span>(sc) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PoolSize&quot;</span>, <span class="st">&quot;TotalVariation&quot;</span>, <span class="st">&quot;Dataset&quot;</span>, <span class="st">&quot;DataType&quot;</span>)
sc<span class="op">$</span>PoolSize &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sc<span class="op">$</span>PoolSize))
sc<span class="op">$</span>TotalVariation &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sc<span class="op">$</span>TotalVariation))

<span class="kw">ggplot</span>(sc, <span class="kw">aes</span>(<span class="dt">x=</span>PoolSize, <span class="dt">y=</span>TotalVariation, <span class="dt">group =</span> Dataset)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Variation per Cell Pool Size, CPM &gt; 0.5&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Dataset, <span class="dt">linetype =</span> DataType)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="kw">max</span>(sc<span class="op">$</span>TotalVariation)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co">#ylab(bquote('Variation ( ~ R[mean])')) +</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">Variation</span> (R[mean] ))),
       <span class="dt">x=</span><span class="st">&quot;Pool size (number of cells)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">linetype =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that we need to pool around 1000 T cells to on average get down to bulk variation level, while we need twice as many of the B cells, likely depending on that the sampling noise is higher In the B10k dataset due to fewer reads. It is also to be noted that the number of cells that is needed in a pool highly depends on gene expression. For highly expressed genes, a few hundreds are enough, while for lowly expressed genes several thousands are needed.</p>
</div>
<div id="btm-score" class="section level2">
<h2>3 BTM score</h2>
<ul>
<li>Load the template file.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">templInfo &lt;-<span class="st"> </span><span class="kw">DSAVEGetStandardTemplate</span>()</code></pre></div>
<ul>
<li>Calculate BTM Score.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tcells_btm &lt;-<span class="st"> </span><span class="kw">DSAVECalcBTMScore</span>(tcells, templInfo, <span class="dt">skipAlignment=</span><span class="ot">FALSE</span>,
                                <span class="dt">iterations =</span> <span class="dv">15</span>, <span class="dt">useLogTransform=</span><span class="ot">FALSE</span>, 
                                <span class="dt">logTPMAddon=</span><span class="dv">1</span>, <span class="dt">silent=</span><span class="ot">FALSE</span>)</code></pre></div>
<ul>
<li>Load the pre-calculated scores.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(datasetScoresHuman)</code></pre></div>
<ul>
<li>Plot the results.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scores &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">sapply</span>(datasetScoresHuman, 
                              <span class="cf">function</span>(x) <span class="kw">c</span>(x[[<span class="dv">1</span>]], x[[<span class="dv">2</span>]]))),
                     <span class="dt">stringsAsFactors =</span> F)

scores &lt;-<span class="st"> </span><span class="kw">rbind.data.frame</span>(scores,<span class="kw">c</span>(<span class="st">&quot;T4k&quot;</span>, tcells_btm<span class="op">$</span>DSAVEScore))
scores<span class="op">$</span>X2 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(scores<span class="op">$</span>X2)

<span class="kw">ggplot</span>(scores, <span class="kw">aes</span>( X1)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">weight =</span> X2)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cell-to-cell Variation for Different Datasets&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;DSAVE BTM score&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the T4k dataset has a BTM variation that is comparable to the other datasets and that the technical quality thus is what can be expected for single-cell RNA-Seq.</p>
<div id="gene-wise-variation" class="section level3">
<h3>4 Gene-wise variation</h3>
<ul>
<li>Run <code>DSAVEGetGeneVariation</code> on the <em>B10k</em> dataset.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bcells_gene_variation &lt;-<span class="st"> </span><span class="kw">DSAVEGetGeneVariation</span>(<span class="kw">as.matrix</span>(bcells), <span class="dt">lb=</span><span class="dv">10</span>, <span class="dt">iterations =</span> <span class="dv">100</span>, <span class="dt">maxNumCells=</span><span class="dv">2000</span>, <span class="dt">silent=</span><span class="ot">FALSE</span>)</code></pre></div>
<ul>
<li>Plot the Variation per Gene</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">id &lt;-<span class="st"> </span><span class="kw">order</span>(bcells_gene_variation<span class="op">$</span>logCVDifference, <span class="dt">decreasing =</span> T)
df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(id), 
                          bcells_gene_variation<span class="op">$</span>logCVDifference[id]))

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>V1, <span class="dt">y=</span>V2, <span class="dt">colour =</span> <span class="st">&quot;B10k&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Variation per Gene&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Gene index&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;BTM variation&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.title=</span><span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is clear that the variation varies much between genes. The stochasticity for a gene can be fairly high, especially for lowly expressed genes. Therefore, it is of interest to compare the p-values as well, where the null hypothesis is that the variation comes from sampling effects.</p>
<ul>
<li>Plot the p-value per gene</li>
</ul>
<p>It is to be noted that these p values are generated with too few iterations; that is why the graph is not smooth. We recommend at least 10,000 iterations to get reliable p values, but that takes much longer to run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pvals &lt;-<span class="st"> </span>bcells_gene_variation<span class="op">$</span>pVals
id &lt;-<span class="st"> </span><span class="kw">order</span>(pvals, <span class="dt">decreasing =</span> T)

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gene =</span> bcells_gene_variation<span class="op">$</span>genes[id], 
                 <span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(pvals[id]), <span class="dt">pvals =</span> pvals[id])
df<span class="op">$</span>gene &lt;-<span class="st"> </span><span class="kw">as.character</span>(df<span class="op">$</span>gene)

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>index, <span class="dt">y=</span>pvals, <span class="dt">colour =</span> <span class="st">&quot;B10k&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;p values per gene&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Gene index&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;p value&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.title=</span><span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that there are fairly many genes with a low p-value. The p-values are not adjusted for multiple testing, which should be done if the function is used for searching for variable genes.</p>
</div>
</div>
<div id="cell-wise-variation" class="section level2">
<h2>5 Cell-wise variation</h2>
<ul>
<li>Subsample the <em>bcells</em> data to 1000 cells and run DSAVEGetSingleCellDivergence.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bcells_id &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(bcells)[<span class="dv">2</span>], <span class="dv">1000</span>)
bcells_cell_divergence &lt;-<span class="st"> </span><span class="kw">DSAVEGetSingleCellDivergence</span>(bcells[,bcells_id],
                              <span class="dt">minUMIsPerCell =</span> <span class="dv">200</span>, <span class="dt">tpmLowerBound =</span> <span class="dv">0</span>,
                              <span class="dt">iterations =</span> <span class="dv">15</span>,<span class="dt">silent=</span><span class="ot">FALSE</span>)</code></pre></div>
<ul>
<li>Estimate the mean log-likelihood</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
numUMIshcatSub2 &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">as.matrix</span>(bcells[,bcells_id]))
linevalYs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span>  <span class="dv">500</span>, <span class="dt">to =</span> <span class="dv">10500</span>, <span class="dt">by =</span> <span class="dv">250</span>)
linevalXes &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(linevalYs))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(linevalYs)){
  ii &lt;-<span class="st"> </span>linevalYs[i]
  lb &lt;-<span class="st"> </span>ii <span class="op">-</span><span class="st"> </span><span class="dv">250</span>
  ub &lt;-<span class="st"> </span>ii <span class="op">+</span><span class="st"> </span><span class="dv">250</span>
  sel &lt;-<span class="st"> </span>numUMIshcatSub2 <span class="op">&gt;=</span><span class="st"> </span>lb <span class="op">&amp;</span><span class="st"> </span>numUMIshcatSub2 <span class="op">&lt;=</span><span class="st"> </span>ub
  <span class="cf">if</span>(<span class="kw">sum</span>(sel)<span class="op">!=</span><span class="dv">0</span>){
    linevalXes[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(bcells_cell_divergence[sel])
  }<span class="cf">else</span>{
    linevalXes[i] &lt;-<span class="st"> </span><span class="ot">NA</span>
  }
}
linevalYs &lt;-<span class="st"> </span><span class="kw">c</span>(linevalYs, 
               <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(numUMIshcatSub2) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(linevalYs)))
linevalXes &lt;-<span class="st"> </span><span class="kw">c</span>(linevalXes, 
                <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(numUMIshcatSub2) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(linevalXes)))
linevalYs[<span class="kw">is.na</span>(linevalXes)] &lt;-<span class="st"> </span><span class="ot">NA</span>
id &lt;-<span class="st"> </span><span class="kw">order</span>(linevalYs, <span class="dt">decreasing =</span> F)
linevalXes &lt;-<span class="st"> </span>linevalXes[id]
linevalYs &lt;-<span class="st"> </span>linevalYs[id]</code></pre></div>
<ul>
<li>Plot the UMI Counts vs Cell Divergence</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(bcells_cell_divergence, <span class="kw">colSums</span>(<span class="kw">as.matrix</span>(bcells[,bcells_id]))))

<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>bcells_cell_divergence, <span class="dt">y=</span>V2, <span class="dt">colour =</span> <span class="st">&quot;Individual cell&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;UMI Counts vs Cell Divergence&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Log-likelihood&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;UMI counts&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.title=</span><span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(linevalXes, linevalYs, <span class="dt">colour=</span><span class="st">&quot;Mean log-likelihood&quot;</span>))
<span class="co">#&gt; Warning: Removed 978 rows containing missing values (geom_path).</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that cells with low number of UMIs are more divergent. Cells below a certain UMI count threshold are usually discarded in a quality control step. We can see that elevating that threshold would likely get rid of more divergent cells, however at the cost of loss of data. Also cells with a high UMI count are on average more divergent; this could be explained by that some of them are doublets, i.e.cases where two or more cells have been accidentally joined and treated as just one cell. Divergence could then come from that the joined cells are of different cell type.</p>
<ul>
<li>Plot the Cell Divergence</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
id &lt;-<span class="st"> </span><span class="kw">order</span>(bcells_cell_divergence, <span class="dt">decreasing =</span> F)
df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bcells_cell_divergence), bcells_cell_divergence[id]))
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>V1, <span class="dt">y=</span>V2, <span class="dt">colour =</span> <span class="st">&quot;B10k&quot;</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cell Divergence&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Cell index&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Log-likelihood&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),
        <span class="dt">legend.title=</span><span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),
        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see that the divergence varies much between cells. A certain variation can be expected due to sampling effects though.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
